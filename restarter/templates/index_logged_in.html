{% extends "base.html" %}

{% block title %}Your Monitors{% endblock %}

{% block content %}
<div class="bg-white p-8 rounded-2xl shadow-lg w-full max-w-4xl space-y-6 mb-8">
  <h2 class="text-2xl font-bold text-gray-800">Your Monitors</h2>

  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
      <tr>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Name</th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Slug</th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">API Key</th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Last Checked</th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-100">
      {% for monitor in monitors %}
      <tr>
        <td class="px-4 py-2 text-sm text-gray-800">{{ monitor.name }}</td>
        <td class="px-4 py-2 text-sm text-gray-800">{{ monitor.slug }}</td>
        <td class="px-4 py-2 text-sm text-gray-800">{{ monitor.api_key }}</td>
        <td class="px-4 py-2 text-sm text-gray-800">{{ monitor.last_checked }}</td>
      </tr>
      {% else %}
      <tr>
        <td colspan="4" class="px-4 py-4 text-center text-gray-500">No monitors set up yet.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
<!-- How to create a monitor block -->
<div class="bg-white p-6 rounded-2xl shadow-lg w-full max-w-4xl mb-6">
  <h2 class="text-xl font-semibold mb-4">Your User API key</h2>
  <p class="mb-2"><b>API key</b>: {{user_key}}</p>
</div>
<div class="bg-white p-6 rounded-2xl shadow-lg w-full max-w-4xl">
  <h2 class="text-xl font-semibold mb-4">How to Create a Monitor</h2>
  <p class="mb-2">Everything here is API-driven! Call the API using, for example, <code>curl</code>:</p>
  <pre class="mb-4"><code>curl -v  -H "x-user-key: {{user_key}}" -XPOST http://c28.ca/monitors \
  -H "content-type: application/json" -d '{"frequency": "60", \
  "name": "a descriptive name", "slug": "first-monitor", \
  "webhook":{"url":"https://webhook.example.com", "method": "post"}}'</code></pre>
  <p class="mb-2">
    You'll receive a unique API key and slug. Your cron job should call the endpoint using a simple
    <code class="bg-gray-100 px-1 py-0.5 rounded text-sm">curl</code> command.
  </p>
  <p class="mb-2">
    If the endpoint isn't called within the expected interval, the configured webhook will be triggered with a custom payload to alert you.
  </p>
</div>
{% endblock %}
